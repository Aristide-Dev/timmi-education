import{c as es,b as ss,r as J,u as ts,j as s,a as ls,H as rs}from"./app-2H9fKCfZ.js";import{k as is,n as as,o as Qe,A as os}from"./app-layout-B-63wUgk.js";import{B as a}from"./index-Pd254wjl.js";import{I as Ne}from"./input-C2NUd8g8.js";import{L as $}from"./label-Das4btLk.js";import{C as ns}from"./checkbox-BrCCPUF3.js";import{B as We}from"./badge-ZBEB6W7r.js";import{D as He,a as Ge,b as Ve,c as $e,d as Je,e as Ke}from"./dialog-CIIDK9Ar.js";import{C as cs,a as ms,b as ds,c as ps}from"./card-D2zalnJq.js";import{I as K}from"./input-error-DYFMZD2C.js";import{F as us}from"./fullscreen-loader-DWGZzQek.js";import{U as fs}from"./users-CefPr0Jp.js";import{P as xs,T as hs}from"./trash-2-DW8XvAaP.js";import{P as js}from"./plus-Bo0Um6-s.js";/* empty css            */import"./index-Dfgpci5l.js";import"./index-meHfxTWa.js";import"./index-DE9K_WNs.js";import"./index-BJUfNzLO.js";import"./appearance-toggle-UOg4SQY0.js";import"./app-logo-icon-CFgwrTPr.js";import"./book-open-SVpjZ0S6.js";import"./circle-check-BCvwYkiE.js";import"./index-8eGi5Yqu.js";import"./check-D7gkjjFl.js";import"./spinner-c2uFqB7i.js";import"./loader-circle-BmDD-9gQ.js";import"./proxy-DKucgXTk.js";const gs=[{title:"Utilisateurs",href:Qe().url}];function Qs(o){const e=es.c(138),{users:Q,roles:W}=o,{auth:X}=ss().props,[be,ye]=J.useState(!1),[we,Y]=J.useState(!1),[n,Pe]=J.useState(null),[r,De]=J.useState(null),[qe,Z]=J.useState(!1);let ee;e[0]===Symbol.for("react.memo_cache_sentinel")?(ee=[],e[0]=ee):ee=e[0];let se;e[1]===Symbol.for("react.memo_cache_sentinel")?(se={name:"",email:"",password:"",password_confirmation:"",roles:ee},e[1]=se):se=e[1];const t=ts(se);let te;e[2]===Symbol.for("react.memo_cache_sentinel")?(te=l=>{Pe(l),ye(!0)},e[2]=te):te=e[2];const Xe=te;let le;e[3]===Symbol.for("react.memo_cache_sentinel")?(le=()=>{Pe(null),ye(!1)},e[3]=le):le=e[3];const Be=le;let re;e[4]!==n?(re=()=>{n&&(Z(!0),ls.delete(is(n.uuid).url,{preserveScroll:!0,onSuccess:()=>{Be(),Z(!1)},onError:()=>{Z(!1)},onFinish:()=>{Z(!1)}}))},e[4]=n,e[5]=re):re=e[5];const Ce=re;let ie;e[6]!==t?(ie=l=>{De(l),t.setData({name:l.name,email:l.email,password:"",password_confirmation:"",roles:l.roles?.map(Ns)||[]}),Y(!0)},e[6]=t,e[7]=ie):ie=e[7];const Se=ie;let ae;e[8]!==t?(ae=()=>{De(null),t.reset(),t.setData({name:"",email:"",password:"",password_confirmation:"",roles:[]}),Y(!0)},e[8]=t,e[9]=ae):ae=e[9];const _e=ae;let oe;e[10]!==t?(oe=()=>{Y(!1),De(null),t.reset(),t.clearErrors()},e[10]=t,e[11]=oe):oe=e[11];const i=oe;let ne;e[12]!==t?(ne=l=>{const Me=t.data.roles||[],Ye=Me.includes(l)?Me.filter(Ze=>Ze!==l):[...Me,l];t.setData("roles",Ye)},e[12]=t,e[13]=ne):ne=e[13];const Fe=ne;let ce;e[14]!==i||e[15]!==r||e[16]!==t?(ce=l=>{l.preventDefault(),r?t.put(as(r.uuid).url,{preserveScroll:!0,onSuccess:()=>{i()}}):t.post(Qe().url,{preserveScroll:!0,onSuccess:()=>{i()}})},e[14]=i,e[15]=r,e[16]=t,e[17]=ce):ce=e[17];const Ee=ce;let me;e[18]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx(rs,{title:"Gestion des utilisateurs"}),e[18]=me):me=e[18];const ze=t.processing||qe,ke=t.processing?r?"Modification de l'utilisateur en cours...":"Création de l'utilisateur en cours...":qe?"Suppression de l'utilisateur en cours...":void 0;let c;e[19]!==ze||e[20]!==ke?(c=s.jsx(us,{isLoading:ze,spinnerType:"loader2",message:ke,subtitle:"Veuillez patienter"}),e[19]=ze,e[20]=ke,e[21]=c):c=e[21];let de;e[22]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold",children:"Gestion des utilisateurs"}),s.jsx("p",{className:"text-muted-foreground text-sm",children:"Gérez les utilisateurs et leurs rôles"})]}),e[22]=de):de=e[22];let pe;e[23]===Symbol.for("react.memo_cache_sentinel")?(pe=s.jsx(js,{className:"mr-2 size-4"}),e[23]=pe):pe=e[23];let m;e[24]!==_e?(m=s.jsxs("div",{className:"flex items-center justify-between",children:[de,s.jsxs(a,{onClick:_e,children:[pe,"Nouvel utilisateur"]})]}),e[24]=_e,e[25]=m):m=e[25];let ue;e[26]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx(ds,{children:s.jsx(ps,{children:"Liste des utilisateurs"})}),e[26]=ue):ue=e[26];let d;e[27]!==X||e[28]!==Se||e[29]!==Q?(d=s.jsxs(cs,{children:[ue,s.jsx(ms,{children:Q.length===0?s.jsxs("div",{className:"py-8 text-center text-muted-foreground",children:[s.jsx(fs,{className:"mx-auto mb-4 size-12 opacity-50"}),s.jsx("p",{children:"Aucun utilisateur trouvé"})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Nom"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Email"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Rôles"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Email vérifié"}),s.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"Actions"})]})}),s.jsx("tbody",{children:Q.map(l=>s.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsx("div",{className:"font-medium",children:l.name})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("div",{className:"text-sm",children:l.email})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("div",{className:"flex flex-wrap gap-1",children:l.roles&&l.roles.length>0?l.roles.map(vs):s.jsx("span",{className:"text-muted-foreground text-xs",children:"Aucun rôle"})})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx(We,{variant:l.email_verified_at?"success":"warning",children:l.email_verified_at?"Vérifié":"Non vérifié"})}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(a,{variant:"ghost",size:"sm",onClick:()=>Se(l),children:s.jsx(xs,{className:"size-4"})}),s.jsx(a,{variant:"ghost",size:"sm",onClick:()=>Xe(l),disabled:l.id===X.user.id,title:l.id===X.user.id?"Vous ne pouvez pas supprimer votre propre compte":"Supprimer",children:s.jsx(hs,{className:"size-4 text-destructive"})})]})})]},l.id))})]})})})]}),e[27]=X,e[28]=Se,e[29]=Q,e[30]=d):d=e[30];const Ae=r?"Modifier l'utilisateur":"Créer un nouvel utilisateur";let p;e[31]!==Ae?(p=s.jsx(He,{children:Ae}),e[31]=Ae,e[32]=p):p=e[32];const Re=r?"Modifiez les informations de l'utilisateur ci-dessous.":"Remplissez les informations pour créer un nouvel utilisateur.";let u;e[33]!==Re?(u=s.jsx(Ge,{children:Re}),e[33]=Re,e[34]=u):u=e[34];let f;e[35]!==p||e[36]!==u?(f=s.jsxs(Ve,{children:[p,u]}),e[35]=p,e[36]=u,e[37]=f):f=e[37];let fe;e[38]===Symbol.for("react.memo_cache_sentinel")?(fe=s.jsx($,{htmlFor:"name",children:"Nom *"}),e[38]=fe):fe=e[38];let x;e[39]!==t?(x=l=>t.setData("name",l.target.value),e[39]=t,e[40]=x):x=e[40];let h;e[41]!==t.data.name||e[42]!==x?(h=s.jsx(Ne,{id:"name",value:t.data.name,onChange:x,placeholder:"Ex: Jean Dupont",required:!0}),e[41]=t.data.name,e[42]=x,e[43]=h):h=e[43];let j;e[44]!==t.errors.name?(j=s.jsx(K,{message:t.errors.name}),e[44]=t.errors.name,e[45]=j):j=e[45];let g;e[46]!==h||e[47]!==j?(g=s.jsxs("div",{className:"grid gap-2",children:[fe,h,j]}),e[46]=h,e[47]=j,e[48]=g):g=e[48];let xe;e[49]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx($,{htmlFor:"email",children:"Email *"}),e[49]=xe):xe=e[49];let v;e[50]!==t?(v=l=>t.setData("email",l.target.value),e[50]=t,e[51]=v):v=e[51];let N;e[52]!==t.data.email||e[53]!==v?(N=s.jsx(Ne,{id:"email",type:"email",value:t.data.email,onChange:v,placeholder:"Ex: jean.dupont@example.com",required:!0}),e[52]=t.data.email,e[53]=v,e[54]=N):N=e[54];let b;e[55]!==t.errors.email?(b=s.jsx(K,{message:t.errors.email}),e[55]=t.errors.email,e[56]=b):b=e[56];let y;e[57]!==N||e[58]!==b?(y=s.jsxs("div",{className:"grid gap-2",children:[xe,N,b]}),e[57]=N,e[58]=b,e[59]=y):y=e[59];const Te=r?"Nouveau mot de passe":"Mot de passe *";let w;e[60]!==r?(w=r&&s.jsx("span",{className:"text-muted-foreground text-xs font-normal ml-2",children:"(Laissez vide pour ne pas modifier)"}),e[60]=r,e[61]=w):w=e[61];let D;e[62]!==Te||e[63]!==w?(D=s.jsxs($,{htmlFor:"password",children:[Te,w]}),e[62]=Te,e[63]=w,e[64]=D):D=e[64];let C;e[65]!==t?(C=l=>t.setData("password",l.target.value),e[65]=t,e[66]=C):C=e[66];const Le=!r;let S;e[67]!==t.data.password||e[68]!==C||e[69]!==Le?(S=s.jsx(Ne,{id:"password",type:"password",value:t.data.password,onChange:C,placeholder:"••••••••",required:Le}),e[67]=t.data.password,e[68]=C,e[69]=Le,e[70]=S):S=e[70];let _;e[71]!==t.errors.password?(_=s.jsx(K,{message:t.errors.password}),e[71]=t.errors.password,e[72]=_):_=e[72];let F;e[73]!==D||e[74]!==S||e[75]!==_?(F=s.jsxs("div",{className:"grid gap-2",children:[D,S,_]}),e[73]=D,e[74]=S,e[75]=_,e[76]=F):F=e[76];let E;e[77]!==r||e[78]!==t?(E=(!r||t.data.password)&&s.jsxs("div",{className:"grid gap-2",children:[s.jsx($,{htmlFor:"password_confirmation",children:"Confirmation du mot de passe *"}),s.jsx(Ne,{id:"password_confirmation",type:"password",value:t.data.password_confirmation,onChange:l=>t.setData("password_confirmation",l.target.value),placeholder:"••••••••",required:!r||!!t.data.password}),s.jsx(K,{message:t.errors.password_confirmation})]}),e[77]=r,e[78]=t,e[79]=E):E=e[79];let he;e[80]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx($,{children:"Rôles"}),e[80]=he):he=e[80];let z;e[81]!==t.data.roles||e[82]!==Fe||e[83]!==W?(z=W.length===0?s.jsx("p",{className:"text-muted-foreground text-sm",children:"Aucun rôle disponible"}):W.map(l=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ns,{id:`role-${l.id}`,checked:t.data.roles?.includes(l.id),onCheckedChange:()=>Fe(l.id)}),s.jsx($,{htmlFor:`role-${l.id}`,className:"cursor-pointer flex-1",children:l.name})]},l.id)),e[81]=t.data.roles,e[82]=Fe,e[83]=W,e[84]=z):z=e[84];let k;e[85]!==z?(k=s.jsx("div",{className:"space-y-2 rounded-md border p-3",children:z}),e[85]=z,e[86]=k):k=e[86];let A;e[87]!==t.errors.roles?(A=s.jsx(K,{message:t.errors.roles}),e[87]=t.errors.roles,e[88]=A):A=e[88];let R;e[89]!==k||e[90]!==A?(R=s.jsxs("div",{className:"grid gap-2",children:[he,k,A]}),e[89]=k,e[90]=A,e[91]=R):R=e[91];let T;e[92]!==i||e[93]!==t.processing?(T=s.jsx(a,{type:"button",variant:"danger",onClick:i,disabled:t.processing,children:"Annuler"}),e[92]=i,e[93]=t.processing,e[94]=T):T=e[94];const Ue=r?"Modifier":"Créer";let L;e[95]!==t.processing||e[96]!==Ue?(L=s.jsx(a,{type:"submit",disabled:t.processing,children:Ue}),e[95]=t.processing,e[96]=Ue,e[97]=L):L=e[97];let U;e[98]!==T||e[99]!==L?(U=s.jsxs($e,{children:[T,L]}),e[98]=T,e[99]=L,e[100]=U):U=e[100];let I;e[101]!==Ee||e[102]!==g||e[103]!==y||e[104]!==F||e[105]!==E||e[106]!==R||e[107]!==U?(I=s.jsxs("form",{onSubmit:Ee,className:"space-y-4",children:[g,y,F,E,R,U]}),e[101]=Ee,e[102]=g,e[103]=y,e[104]=F,e[105]=E,e[106]=R,e[107]=U,e[108]=I):I=e[108];let O;e[109]!==f||e[110]!==I?(O=s.jsxs(Je,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[f,I]}),e[109]=f,e[110]=I,e[111]=O):O=e[111];let M;e[112]!==we||e[113]!==O?(M=s.jsx(Ke,{open:we,onOpenChange:Y,children:O}),e[112]=we,e[113]=O,e[114]=M):M=e[114];let je;e[115]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx(He,{children:"Confirmer la suppression"}),e[115]=je):je=e[115];const Ie=n?.name;let P;e[116]!==Ie?(P=s.jsx("strong",{children:Ie}),e[116]=Ie,e[117]=P):P=e[117];const Oe=n?.email;let q;e[118]!==P||e[119]!==Oe?(q=s.jsxs(Ve,{children:[je,s.jsxs(Ge,{children:["Êtes-vous sûr de vouloir supprimer l'utilisateur"," ",P," (",Oe,") ? Cette action est irréversible et supprimera également toutes les associations avec les rôles."]})]}),e[118]=P,e[119]=Oe,e[120]=q):q=e[120];let ge;e[121]===Symbol.for("react.memo_cache_sentinel")?(ge=s.jsx(a,{variant:"secondary",onClick:Be,children:"Annuler"}),e[121]=ge):ge=e[121];let B;e[122]!==Ce?(B=s.jsxs($e,{children:[ge,s.jsx(a,{variant:"destructive",onClick:Ce,children:"Supprimer"})]}),e[122]=Ce,e[123]=B):B=e[123];let H;e[124]!==q||e[125]!==B?(H=s.jsxs(Je,{children:[q,B]}),e[124]=q,e[125]=B,e[126]=H):H=e[126];let G;e[127]!==be||e[128]!==H?(G=s.jsx(Ke,{open:be,onOpenChange:ye,children:H}),e[127]=be,e[128]=H,e[129]=G):G=e[129];let V;e[130]!==m||e[131]!==d||e[132]!==M||e[133]!==G?(V=s.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 overflow-x-auto rounded-xl p-4",children:[m,d,M,G]}),e[130]=m,e[131]=d,e[132]=M,e[133]=G,e[134]=V):V=e[134];let ve;return e[135]!==c||e[136]!==V?(ve=s.jsxs(os,{breadcrumbs:gs,children:[me,c,V]}),e[135]=c,e[136]=V,e[137]=ve):ve=e[137],ve}function vs(o){return s.jsx(We,{variant:"secondary",children:o.name},o.id)}function Ns(o){return o.id}export{Qs as default};
